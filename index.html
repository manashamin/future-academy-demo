<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Future Academy — Admission Form</title>
  <style>
    body{font-family:Inter,Arial,sans-serif;background:linear-gradient(180deg,#f4f7fb,#eef3fb);margin:0;padding:24px}
    .card{max-width:820px;margin:24px auto;background:#fff;padding:24px;border-radius:12px;box-shadow:0 8px 28px rgba(20,30,70,.06)}
    h1{text-align:center;color:#213251;margin:6px 0 18px}
    label{display:block;font-weight:600;margin-top:12px;color:#2a3b57}
    input,select,textarea{width:100%;padding:10px;border:1px solid #d7e0ef;border-radius:8px;font-size:14px}
    .muted{color:#6b7a93;font-weight:500;font-size:13px;margin-top:6px}
    .section{margin-top:18px;padding-top:14px;border-top:1px solid #eef3fb}
    .btn{display:inline-block;width:100%;padding:12px;background:#2b3a67;color:#fff;border:none;border-radius:10px;font-weight:700;margin-top:18px;cursor:pointer}
    .btn:hover{opacity:.95}
    .small{font-size:13px;color:#55637a}
    #photoPreview{margin-top:10px;display:flex;gap:12px;align-items:center}
    #photoPreview img{max-width:120px;max-height:120px;border-radius:6px;border:1px solid #e2e8f0}
    .error{color:#b00020;font-weight:700;margin-top:8px}
    .hidden{display:none}
    .field-row{margin-bottom:6px}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Future Academy — Admission Form</h1>

    <!-- Replace YOUR_FORM_ENDPOINT with the endpoint from Formspree/Getform/your backend -->
    <form id="admissionForm" action="YOUR_FORM_ENDPOINT" method="POST" enctype="multipart/form-data" novalidate>
      <!-- Personal -->
      <div class="section" aria-labelledby="personalTitle">
        <h2 id="personalTitle" class="small">Personal Information</h2>

        <label for="fullName">Full name</label>
        <input id="fullName" name="fullName" required>

        <label for="dob">Date of birth</label>
        <input id="dob" name="dob" type="date" required>

        <label>Gender</label>
        <div class="field-row">
          <label><input type="radio" name="gender" value="Male" required> Male</label>
          <label style="margin-left:18px"><input type="radio" name="gender" value="Female"> Female</label>
        </div>

        <label for="guardianName">Guardian's name</label>
        <input id="guardianName" name="guardianName" required>

        <label for="relationship">Relationship</label>
        <input id="relationship" name="relationship" required>

        <label for="phone">Phone number</label>
        <input id="phone" name="phone" placeholder="+91XXXXXXXXXX" required>

        <div class="muted">Phone will be validated as +91 followed by 10 digits.</div>

        <label for="email">Email (Gmail only)</label>
        <input id="email" name="email" type="email" placeholder="example@gmail.com" required>
        <div class="muted">After you enter a valid Gmail address, photo upload will appear.</div>

        <!-- photo field hidden until valid Gmail entered -->
        <div id="photoField" class="hidden">
          <label for="photo">Upload Passport Photo (JPG / JPEG / PNG / PDF) — max 3MB</label>
          <input id="photo" name="photo" type="file" accept=".jpg,.jpeg,.png,.pdf">
          <div id="photoPreview" class="hidden"></div>
          <div id="photoError" class="error hidden"></div>
        </div>
      </div>

      <!-- Academic -->
      <div class="section" aria-labelledby="acadTitle">
        <h2 id="acadTitle" class="small">Academic Information</h2>

        <label for="tenthMarks">10th — Marks obtained (total)</label>
        <input id="tenthMarks" name="tenthMarks" type="number" min="0" required>

        <label for="tenthMax">10th — Maximum marks</label>
        <input id="tenthMax" name="tenthMax" type="number" min="1" required>

        <label for="tenthPercentage">10th Percentage</label>
        <input id="tenthPercentage" name="tenthPercentage" readonly>

        <label for="stream">12th Stream</label>
        <select id="stream" name="stream" required>
          <option value="">-- Select Stream --</option>
          <option value="science-cs">Science (Computer Science)</option>
          <option value="science-bio">Science (Biology + Maths)</option>
          <option value="pure-science">Pure Science (Bio + CS, no Maths)</option>
          <option value="commerce-ca">Commerce (with Computer Application)</option>
          <option value="commerce-bm">Commerce (with Business Maths)</option>
        </select>

        <div id="subjectMarks" class="hidden" aria-live="polite"></div>

        <label for="twelfthPercentage">12th Percentage</label>
        <input id="twelfthPercentage" name="twelfthPercentage" readonly>
      </div>

      <button class="btn" type="submit">Submit Application</button>
      <div id="formMsg" class="muted" aria-live="polite" style="margin-top:10px"></div>
    </form>
  </main>

  <script>
    // Elements
    const phone = document.getElementById('phone');
    const email = document.getElementById('email');
    const photoFieldWrap = document.getElementById('photoField');
    const photoInput = document.getElementById('photo');
    const photoPreview = document.getElementById('photoPreview');
    const photoError = document.getElementById('photoError');

    const tenthMarks = document.getElementById('tenthMarks');
    const tenthMax = document.getElementById('tenthMax');
    const tenthPercentage = document.getElementById('tenthPercentage');

    const stream = document.getElementById('stream');
    const subjectMarks = document.getElementById('subjectMarks');
    const twelfthPercentage = document.getElementById('twelfthPercentage');

    const form = document.getElementById('admissionForm');
    const formMsg = document.getElementById('formMsg');

    // ----- Phone behavior: ensure +91 prefix, user types the 10 digits -----
    phone.addEventListener('focus', () => {
      if (!phone.value.startsWith('+91')) phone.value = '+91';
    });
    phone.addEventListener('input', () => {
      if (!phone.value.startsWith('+91')) phone.value = '+91' + phone.value.replace(/[^0-9]/g,'');
      // keep only +91 + digits
      phone.value = '+91' + phone.value.replace(/^\+91/,'').replace(/\D/g,'').slice(0,10);
    });

    // ----- 10th percentage auto-calc -----
    function calc10th() {
      const got = parseFloat(tenthMarks.value);
      const max = parseFloat(tenthMax.value);
      if (!isNaN(got) && !isNaN(max) && max>0) {
        const p = (got / max) * 100;
        tenthPercentage.value = p.toFixed(2) + '%';
      } else tenthPercentage.value = '';
    }
    tenthMarks.addEventListener('input', calc10th);
    tenthMax.addEventListener('input', calc10th);

    // ----- 12th dynamic subjects setup -----
    const subjectSets = {
      "science-cs": ["Language","English","Physics","Chemistry","Mathematics","Computer Science"],
      "science-bio": ["Language","English","Physics","Chemistry","Mathematics","Biology"],
      "pure-science": ["Language","English","Physics","Chemistry","Computer Science","Biology"],
      "commerce-ca": ["Language","English","Commerce","Accounts","Computer Application","Economics"],
      "commerce-bm": ["Language","English","Commerce","Accounts","Business Mathematics","Economics"]
    };

    function buildSubjects(key) {
      subjectMarks.innerHTML = '';
      if (!subjectSets[key]) { subjectMarks.classList.add('hidden'); return; }
      const arr = subjectSets[key];
      arr.forEach(sub => {
        const lbl = document.createElement('label');
        lbl.textContent = sub + ' Marks (out of 100)';
        lbl.setAttribute('for','sub_'+sub.replace(/\s+/g,'_').toLowerCase());
        const inp = document.createElement('input');
        inp.type = 'number';
        inp.min = 0; inp.max = 100;
        inp.required = true;
        inp.name = 'sub_' + sub.replace(/\s+/g,'_').toLowerCase();
        inp.id = 'sub_' + sub.replace(/\s+/g,'_').toLowerCase();
        inp.addEventListener('input', calc12th);
        subjectMarks.appendChild(lbl);
        subjectMarks.appendChild(inp);
      });
      subjectMarks.classList.remove('hidden');
    }

    stream.addEventListener('change', () => buildSubjects(stream.value));

    // ----- 12th percentage calc (all subjects assumed out of 100) -----
    function calc12th() {
      const inputs = subjectMarks.querySelectorAll('input[type="number"]');
      if (inputs.length === 0) { twelfthPercentage.value = ''; return; }
      let sum = 0; let filled = 0;
      inputs.forEach(i => {
        const v = parseFloat(i.value);
        if (!isNaN(v)) { sum += v; filled++; }
      });
      if (filled === inputs.length) {
        const perc = (sum / (inputs.length * 100)) * 100;
        twelfthPercentage.value = perc.toFixed(2) + '%';
      } else twelfthPercentage.value = '';
    }

    // ----- Email triggers photo field (Gmail only) -----
    email.addEventListener('input', () => {
      const ok = /^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(email.value.trim());
      if (ok) {
        photoFieldWrap.classList.remove('hidden');
        photoInput.required = true;
      } else {
        photoFieldWrap.classList.add('hidden');
        photoInput.required = false;
        photoPreview.classList.add('hidden');
        photoPreview.innerHTML = '';
        photoError.classList.add('hidden');
      }
    });

    // ----- Photo validation + preview -----
    const MAX_BYTES = 3 * 1024 * 1024; // 3MB
    photoInput.addEventListener('change', () => {
      photoPreview.innerHTML = '';
      photoPreview.classList.add('hidden');
      photoError.classList.add('hidden');
      const f = photoInput.files[0];
      if (!f) return;
      const allowed = ['image/jpeg','image/png','application/pdf','image/jpg'];
      if (!allowed.includes(f.type)) {
        photoError.textContent = 'Invalid file type. Allowed: JPG, JPEG, PNG, PDF.';
        photoError.classList.remove('hidden');
        photoInput.value = '';
        return;
      }
      if (f.size > MAX_BYTES) {
        photoError.textContent = 'File too large. Max 3 MB.';
        photoError.classList.remove('hidden');
        photoInput.value = '';
        return;
      }
      // If image -> preview
      if (f.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (ev) => {
          const img = document.createElement('img');
          img.src = ev.target.result;
          img.alt = 'Photo preview';
          photoPreview.appendChild(img);
          photoPreview.classList.remove('hidden');
        };
        reader.readAsDataURL(f);
      } else {
        // PDF -> show filename
        photoPreview.textContent = 'Selected file: ' + f.name;
        photoPreview.classList.remove('hidden');
      }
    });

    // ----- Submission: client-side validation & note about backend -----
    form.addEventListener('submit', function(evt) {
      formMsg.textContent = '';
      // phone validation
      if (!/^\+91\d{10}$/.test(phone.value)) {
        evt.preventDefault();
        formMsg.textContent = 'Phone must be +91 followed by 10 digits.';
        formMsg.style.color = '#b00020';
        return;
      }
      // email validation
      if (!/^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(email.value.trim())) {
        evt.preventDefault();
        formMsg.textContent = 'Please provide a valid Gmail address.';
        formMsg.style.color = '#b00020';
        return;
      }
      // ensure 12th percentage calculated (ensures subjects filled)
      if (!twelfthPercentage.value) {
        evt.preventDefault();
        formMsg.textContent = 'Please select 12th stream and enter all subject marks.';
        formMsg.style.color = '#b00020';
        return;
      }
      // NOTE: On GitHub Pages this form will not store the photo unless you set up a real endpoint
      formMsg.style.color = '#2b7a2b';
      formMsg.textContent = 'Submitting... (if you have not configured an endpoint, the file will not be stored).';
      // If action is still placeholder, stop and show helpful message
      if (form.getAttribute('action') === 'YOUR_FORM_ENDPOINT') {
        evt.preventDefault();
        formMsg.style.color = '#b00020';
        formMsg.textContent = 'No backend endpoint configured. To store uploads, sign up for Formspree (or Netlify Forms), then replace YOUR_FORM_ENDPOINT in the form tag with your endpoint URL.';
      }
      // If you have a real endpoint, form will POST with file as multipart/form-data.
    });
  </script>
</body>
</html>
